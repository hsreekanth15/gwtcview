<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GW Events Sky Plot</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<style>

<style>
  body { font-family: Arial, sans-serif; }
  .plot-container {
    display: flex;          /* enable horizontal layout */
    justify-content: space-between; /* add spacing between plots */
  }
  .plot {
    width: 48%;             /* each takes ~half the page */
    height: 90vh;           /* keep tall plots */
  }
</style>


</style>
</head>
<body>
<h2>Gravitational Wave Events </h2>
<div class="plot-container">
<div id="plot-ra" class="plot"></div>
<div id="plot-dec" class="plot"></div>   
</div>
<script>
Papa.parse("catalog/gwtc4p0.csv", {
    download: true,
    header: true,
    dynamicTyping: true,
    complete: function(results) {
        const data = results.data.filter(d => d.ra && d.dec && d.luminosity_distance);
        console.log("Loaded rows:", data.length, data); // debug

        if(data.length === 0) {
            alert("No valid rows loaded. Check CSV path or format.");
            return;
        }

        const r = data.map(d => d.luminosity_distance);
        const theta = data.map(d => (d.ra / (2*Math.PI)) * 360);
        const dec = data.map(d => (d.dec/(2*Math.PI)) * 360);
        const text = data.map(d => `${d.Event}<br>Distance: ${d.luminosity_distance.toFixed(0)} Mpc`);

        const trace = {
            type: 'scatterpolar',
            r: r,
            theta: theta,
            mode: 'markers',
            marker: { size: 8, color: r, colorscale: 'Viridis', colorbar: { title: 'Distance (Mpc)' } },
            text: text,
            hoverinfo: 'text'
        };

        const trace1 = {
            type: 'scatterpolar',
            r: r,
            theta: dec,
            mode: 'markers',
            marker: { size: 8, color: r, colorscale: 'Plasma', colorbar: { title: 'Distance (Mpc)' } },
            text: text,
            hoverinfo: 'text'
        };

        const layout = {
            paper_bgcolor: '#fff',
            polar: { radialaxis: { title: 'Luminosity Distance (Mpc)' } },
            showlegend: false,
            title: 'RA vs Luminosity_distance'
        };

        const layout_dec = {
            paper_bgcolor: '#fff',
            polar: { radialaxis: { title: 'Luminosity Distance (Mpc)' } },
            showlegend: false,
            title: 'DEC vs Luminosity_distance'
        };
        Plotly.newPlot('plot-ra', [trace], layout, {responsive: true});
      
        Plotly.newPlot('plot-dec', [trace1], layout_dec, {responsive: true});
    }
});
</script>

</body>
</html>
